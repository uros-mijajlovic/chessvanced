(()=>{"use strict";var e,t,r,o,n={618:(e,t,r)=>{r.d(t,{qQ:()=>M});const o="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",n=["1-0","0-1","1/2-1/2","*"],a={b:[16,32,17,15],w:[-16,-32,-17,-15]},p={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},i=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],s=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],c={p:0,n:1,b:2,r:3,q:4,k:5},l={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},P={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},h={w:[{square:P.a1,flag:l.QSIDE_CASTLE},{square:P.h1,flag:l.KSIDE_CASTLE}],b:[{square:P.a8,flag:l.QSIDE_CASTLE},{square:P.h8,flag:l.KSIDE_CASTLE}]};function d(e){var t=e.charAt(0);if(t>="a"&&t<="h"){if(e.match(/[a-h]\d.*[a-h]\d/))return;return C}return"o"===(t=t.toLowerCase())?B:t}function u(e){return e.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function f(e){return e>>4}function v(e){return 15&e}function g(e){var t=v(e),r=f(e);return"abcdefgh".substring(t,t+1)+"87654321".substring(r,r+1)}function b(e){return e===E?N:E}function m(e){var t=e instanceof Array?[]:{};for(var r in e)t[r]="object"==typeof r?m(e[r]):e[r];return t}function R(e){return e.replace(/^\s+|\s+$/g,"")}const N="b",E="w",k=-1,C="p",y="b",B="k",O=(function(){for(var e=[],t=P.a8;t<=P.h1;t++)136&t?t+=7:e.push(g(t))}(),{NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"}),M=function(e){var t=new Array(128),r={w:k,b:k},M=E,w={w:0,b:0},q=k,A=0,Q=1,K=[],_={},F={};function T(e){void 0===e&&(e=!1),t=new Array(128),r={w:k,b:k},M=E,w={w:0,b:0},q=k,A=0,Q=1,K=[],e||(_={}),F={},U(x())}function I(){for(var e=[],t={},r=function(e){e in F&&(t[e]=F[e])};K.length>0;)e.push(oe());for(r(x());e.length>0;)re(e.pop()),r(x());F=t}function S(){L(o)}function L(e,t){void 0===t&&(t=!1);var r=e.split(/\s+/),o=r[0],n=0;if(!D(e).valid)return!1;T(t);for(var a=0;a<o.length;a++){var p=o.charAt(a);if("/"===p)n+=8;else if(-1!=="0123456789".indexOf(p))n+=parseInt(p,10);else{var i=p<"a"?E:N;j({type:p.toLowerCase(),color:i},g(n)),n++}}return M=r[1],r[2].indexOf("K")>-1&&(w.w|=l.KSIDE_CASTLE),r[2].indexOf("Q")>-1&&(w.w|=l.QSIDE_CASTLE),r[2].indexOf("k")>-1&&(w.b|=l.KSIDE_CASTLE),r[2].indexOf("q")>-1&&(w.b|=l.QSIDE_CASTLE),q="-"===r[3]?k:P[r[3]],A=parseInt(r[4],10),Q=parseInt(r[5],10),U(x()),!0}function D(e){var t=e.split(/\s+/);if(6!==t.length)return{valid:!1,error_number:1,error:"FEN string must contain six space-delimited fields."};if(isNaN(parseInt(t[5]))||parseInt(t[5],10)<=0)return{valid:!1,error_number:2,error:"6th field (move number) must be a positive integer."};if(isNaN(parseInt(t[4]))||parseInt(t[4],10)<0)return{valid:!1,error_number:3,error:"5th field (half move counter) must be a non-negative integer."};if(!/^(-|[abcdefgh][36])$/.test(t[3]))return{valid:!1,error_number:4,error:"4th field (en-passant square) is invalid."};if(!/^(KQ?k?q?|Qk?q?|kq?|q|-)$/.test(t[2]))return{valid:!1,error_number:5,error:"3rd field (castling availability) is invalid."};if(!/^(w|b)$/.test(t[1]))return{valid:!1,error_number:6,error:"2nd field (side to move) is invalid."};var r=t[0].split("/");if(8!==r.length)return{valid:!1,error_number:7,error:"1st field (piece positions) does not contain 8 '/'-delimited rows."};for(var o=0;o<r.length;o++){for(var n=0,a=!1,p=0;p<r[o].length;p++)if(isNaN(r[o][p])){if(!/^[prnbqkPRNBQK]$/.test(r[o][p]))return{valid:!1,error_number:9,error:"1st field (piece positions) is invalid [invalid piece]."};n+=1,a=!1}else{if(a)return{valid:!1,error_number:8,error:"1st field (piece positions) is invalid [consecutive numbers]."};n+=parseInt(r[o][p],10),a=!0}if(8!==n)return{valid:!1,error_number:10,error:"1st field (piece positions) is invalid [row too large]."}}return"3"==t[3][1]&&"w"==t[1]||"6"==t[3][1]&&"b"==t[1]?{valid:!1,error_number:11,error:"Illegal en-passant square"}:{valid:!0,error_number:0,error:"No errors."}}function x(){for(var e=0,r="",o=P.a8;o<=P.h1;o++){if(null==t[o])e++;else{e>0&&(r+=e,e=0);var n=t[o].color,a=t[o].type;r+=n===E?a.toUpperCase():a.toLowerCase()}o+1&136&&(e>0&&(r+=e),o!==P.h1&&(r+="/"),e=0,o+=8)}var p="";w[E]&l.KSIDE_CASTLE&&(p+="K"),w[E]&l.QSIDE_CASTLE&&(p+="Q"),w[N]&l.KSIDE_CASTLE&&(p+="k"),w[N]&l.QSIDE_CASTLE&&(p+="q"),p=p||"-";var i=q===k?"-":g(q);return[r,M,p,i,A,Q].join(" ")}function V(e){for(var t=0;t<e.length;t+=2)"string"==typeof e[t]&&"string"==typeof e[t+1]&&(_[e[t]]=e[t+1]);return _}function U(e){K.length>0||(e!==o?(_.SetUp="1",_.FEN=e):(delete _.SetUp,delete _.FEN))}function H(e){var r=t[P[e]];return r?{type:r.type,color:r.color}:null}function j(e,o){if(!("type"in e)||!("color"in e))return!1;if(-1==="pnbrqkPNBRQK".indexOf(e.type.toLowerCase()))return!1;if(!(o in P))return!1;var n=P[o];return(e.type!=B||r[e.color]==k||r[e.color]==n)&&(t[n]={type:e.type,color:e.color},e.type===B&&(r[e.color]=n),U(x()),!0)}function G(e,t,r,o,n){var a={color:M,from:t,to:r,flags:o,piece:e[t].type};return n&&(a.flags|=l.PROMOTION,a.promotion=n),e[r]?a.captured=e[r].type:o&l.EP_CAPTURE&&(a.captured=C),a}function $(e){function o(e,t,r,o,n){if(e[r].type!==C||0!==f(o)&&7!==f(o))t.push(G(e,r,o,n));else for(var a=["q","r",y,"n"],p=0,i=a.length;p<i;p++)t.push(G(e,r,o,n,a[p]))}var n=[],i=M,s=b(i),c={b:1,w:6},h=P.a8,d=P.h1,u=!1,v=void 0===e||!("legal"in e)||e.legal,g=void 0===e||!("piece"in e)||"string"!=typeof e.piece||e.piece.toLowerCase();if(void 0!==e&&"square"in e){if(!(e.square in P))return[];h=d=P[e.square],u=!0}for(var m=h;m<=d;m++)if(136&m)m+=7;else{var R=t[m];if(null!=R&&R.color===i)if(R.type!==C||!0!==g&&g!==C){if(!0===g||g===R.type)for(var N=0,E=p[R.type].length;N<E;N++){var k=p[R.type][N];for(O=m;!(136&(O+=k));){if(null!=t[O]){if(t[O].color===i)break;o(t,n,m,O,l.CAPTURE);break}if(o(t,n,m,O,l.NORMAL),"n"===R.type||"k"===R.type)break}}}else{var O=m+a[i][0];if(null==t[O]){o(t,n,m,O,l.NORMAL);O=m+a[i][1];c[i]===f(m)&&null==t[O]&&o(t,n,m,O,l.BIG_PAWN)}for(N=2;N<4;N++)136&(O=m+a[i][N])||(null!=t[O]&&t[O].color===s?o(t,n,m,O,l.CAPTURE):O===q&&o(t,n,m,q,l.EP_CAPTURE))}}if(!(!0!==g&&g!==B||u&&d!==r[i])){if(w[i]&l.KSIDE_CASTLE){var A=(Q=r[i])+2;null!=t[Q+1]||null!=t[A]||Y(s,r[i])||Y(s,Q+1)||Y(s,A)||o(t,n,r[i],A,l.KSIDE_CASTLE)}var Q;if(w[i]&l.QSIDE_CASTLE)A=(Q=r[i])-2,null!=t[Q-1]||null!=t[Q-2]||null!=t[Q-3]||Y(s,r[i])||Y(s,Q-1)||Y(s,A)||o(t,n,r[i],A,l.QSIDE_CASTLE)}if(!v)return n;var K=[];for(m=0,E=n.length;m<E;m++)re(n[m]),J(i)||K.push(n[m]),oe();return K}function W(e,t){var r="";if(e.flags&l.KSIDE_CASTLE)r="O-O";else if(e.flags&l.QSIDE_CASTLE)r="O-O-O";else{if(e.piece!==C){var o=function(e,t){for(var r=e.from,o=e.to,n=e.piece,a=0,p=0,i=0,s=0,c=t.length;s<c;s++){var l=t[s].from,P=t[s].to;n===t[s].piece&&r!==l&&o===P&&(a++,f(r)===f(l)&&p++,v(r)===v(l)&&i++)}return a>0?p>0&&i>0?g(r):i>0?g(r).charAt(1):g(r).charAt(0):""}(e,t);r+=e.piece.toUpperCase()+o}e.flags&(l.CAPTURE|l.EP_CAPTURE)&&(e.piece===C&&(r+=g(e.from)[0]),r+="x"),r+=g(e.to),e.flags&l.PROMOTION&&(r+="="+e.promotion.toUpperCase())}return re(e),z()&&(Z()?r+="#":r+="+"),oe(),r}function Y(e,r){for(var o=P.a8;o<=P.h1;o++)if(136&o)o+=7;else if(null!=t[o]&&t[o].color===e){var n=t[o],a=o-r,p=a+119;if(i[p]&1<<c[n.type]){if(n.type===C){if(a>0){if(n.color===E)return!0}else if(n.color===N)return!0;continue}if("n"===n.type||"k"===n.type)return!0;for(var l=s[p],h=o+l,d=!1;h!==r;){if(null!=t[h]){d=!0;break}h+=l}if(!d)return!0}}return!1}function J(e){return Y(b(e),r[e])}function z(){return J(M)}function Z(){return z()&&0===$().length}function X(){return!z()&&0===$().length}function ee(){for(var e={},r=[],o=0,n=0,a=P.a8;a<=P.h1;a++)if(n=(n+1)%2,136&a)a+=7;else{var p=t[a];p&&(e[p.type]=p.type in e?e[p.type]+1:1,p.type===y&&r.push(n),o++)}if(2===o)return!0;if(3===o&&(1===e[y]||1===e.n))return!0;if(o===e[y]+2){var i=0,s=r.length;for(a=0;a<s;a++)i+=r[a];if(0===i||i===s)return!0}return!1}function te(){for(var e=[],t={},r=!1;;){var o=oe();if(!o)break;e.push(o)}for(;;){var n=x().split(" ").slice(0,4).join(" ");if(t[n]=n in t?t[n]+1:1,t[n]>=3&&(r=!0),!e.length)break;re(e.pop())}return r}function re(e){var o=M,n=b(o);if(function(e){K.push({move:e,kings:{b:r.b,w:r.w},turn:M,castling:{b:w.b,w:w.w},ep_square:q,half_moves:A,move_number:Q})}(e),t[e.to]=t[e.from],t[e.from]=null,e.flags&l.EP_CAPTURE&&(M===N?t[e.to-16]=null:t[e.to+16]=null),e.flags&l.PROMOTION&&(t[e.to]={type:e.promotion,color:o}),t[e.to].type===B){if(r[t[e.to].color]=e.to,e.flags&l.KSIDE_CASTLE){var a=e.to-1,p=e.to+1;t[a]=t[p],t[p]=null}else e.flags&l.QSIDE_CASTLE&&(a=e.to+1,p=e.to-2,t[a]=t[p],t[p]=null);w[o]=""}if(w[o])for(var i=0,s=h[o].length;i<s;i++)if(e.from===h[o][i].square&&w[o]&h[o][i].flag){w[o]^=h[o][i].flag;break}if(w[n])for(i=0,s=h[n].length;i<s;i++)if(e.to===h[n][i].square&&w[n]&h[n][i].flag){w[n]^=h[n][i].flag;break}q=e.flags&l.BIG_PAWN?"b"===M?e.to-16:e.to+16:k,e.piece===C||e.flags&(l.CAPTURE|l.EP_CAPTURE)?A=0:A++,M===N&&Q++,M=b(M)}function oe(){var e=K.pop();if(null==e)return null;var o=e.move;r=e.kings,M=e.turn,w=e.castling,q=e.ep_square,A=e.half_moves,Q=e.move_number;var n,a,p=M,i=b(M);if(t[o.from]=t[o.to],t[o.from].type=o.piece,t[o.to]=null,o.flags&l.CAPTURE)t[o.to]={type:o.captured,color:i};else if(o.flags&l.EP_CAPTURE){var s;s=p===N?o.to-16:o.to+16,t[s]={type:C,color:i}}return o.flags&(l.KSIDE_CASTLE|l.QSIDE_CASTLE)&&(o.flags&l.KSIDE_CASTLE?(n=o.to+1,a=o.to-1):o.flags&l.QSIDE_CASTLE&&(n=o.to-2,a=o.to+1),t[n]=t[a],t[a]=null),o}function ne(e,t){for(var r=u(e),o=0;o<2;o++){if(1==o){if(!t)return null;var n=!1;if(c=r.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/)){var a=c[1],p=c[2],i=c[3],s=c[4];1==p.length&&(n=!0)}else{var c;(c=r.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/))&&(a=c[1],p=c[2],i=c[3],s=c[4],1==p.length&&(n=!0))}}for(var l=d(r),h=$({legal:!0,piece:a||l}),f=0,v=h.length;f<v;f++)switch(o){case 0:if(r===u(W(h[f],h)))return h[f];break;case 1:if(c){if(!(a&&a.toLowerCase()!=h[f].piece||P[p]!=h[f].from||P[i]!=h[f].to||s&&s.toLowerCase()!=h[f].promotion))return h[f];if(n){var b=g(h[f].from);if(!(a&&a.toLowerCase()!=h[f].piece||P[i]!=h[f].to||p!=b[0]&&p!=b[1]||s&&s.toLowerCase()!=h[f].promotion))return h[f]}}}}return null}function ae(e){var t=m(e);t.san=W(t,$({legal:!0})),t.to=g(t.to),t.from=g(t.from);var r="";for(var o in l)l[o]&t.flags&&(r+=O[o]);return t.flags=r,t}function pe(e){for(var t=$({legal:!1}),r=0,o=M,n=0,a=t.length;n<a;n++)re(t[n]),J(o)||(e-1>0?r+=pe(e-1):r++),oe();return r}return L(void 0===e?o:e),{load:function(e){return L(e)},reset:function(){return S()},swapTurn:function(){this.turn==E?this.turn=N:this.turn=E},moves:function(e){for(var t=$(e),r=[],o=0,n=t.length;o<n;o++)void 0!==e&&"verbose"in e&&e.verbose?r.push(ae(t[o])):r.push(W(t[o],$({legal:!0})));return r},in_check:function(){return z()},in_checkmate:function(){return Z()},in_stalemate:function(){return X()},in_draw:function(){return A>=100||X()||ee()||te()},insufficient_material:function(){return ee()},in_threefold_repetition:function(){return te()},game_over:function(){return A>=100||Z()||X()||ee()||te()},validate_fen:function(e){return D(e)},fen:function(){return x()},board:function(){for(var e=[],r=[],o=P.a8;o<=P.h1;o++)null==t[o]?r.push(null):r.push({square:g(o),type:t[o].type,color:t[o].color}),o+1&136&&(e.push(r),r=[],o+=8);return e},pgn:function(e){var t="object"==typeof e&&"string"==typeof e.newline_char?e.newline_char:"\n",r="object"==typeof e&&"number"==typeof e.max_width?e.max_width:0,o=[],n=!1;for(var a in _)o.push("["+a+' "'+_[a]+'"]'+t),n=!0;n&&K.length&&o.push(t);for(var p=function(e){var t=F[x()];return void 0!==t&&(e=`${e}${e.length>0?" ":""}{${t}}`),e},i=[];K.length>0;)i.push(oe());var s=[],c="";for(0===i.length&&s.push(p(""));i.length>0;){c=p(c);var l=i.pop();if(K.length||"b"!==l.color)"w"===l.color&&(c.length&&s.push(c),c=Q+".");else{const e=`${Q}. ...`;c=c?`${c} ${e}`:e}c=c+" "+W(l,$({legal:!0})),re(l)}if(c.length&&s.push(p(c)),void 0!==_.Result&&s.push(_.Result),0===r)return o.join("")+s.join(" ");var P=function(){return o.length>0&&" "===o[o.length-1]&&(o.pop(),!0)},h=function(e,n){for(var a of n.split(" "))if(a){if(e+a.length>r){for(;P();)e--;o.push(t),e=0}o.push(a),e+=a.length,o.push(" "),e++}return P()&&e--,e},d=0;for(a=0;a<s.length;a++)d+s[a].length>r&&s[a].includes("{")?d=h(d,s[a]):(d+s[a].length>r&&0!==a?(" "===o[o.length-1]&&o.pop(),o.push(t),d=0):0!==a&&(o.push(" "),d++),o.push(s[a]),d+=s[a].length);return o.join("")},load_pgn:function(e,t){var r=void 0!==t&&"sloppy"in t&&t.sloppy;function o(e){return e.replace(/\\/g,"\\")}e=e.trim();var a="object"==typeof t&&"string"==typeof t.newline_char?t.newline_char:"\r?\n",p=new RegExp("^(\\[((?:"+o(a)+")|.)*\\])(?:\\s*"+o(a)+"){2}"),i=p.test(e)?p.exec(e)[1]:"";S();var s=function(e,t){for(var r="object"==typeof t&&"string"==typeof t.newline_char?t.newline_char:"\r?\n",n={},a=e.split(new RegExp(o(r))),p="",i="",s=0;s<a.length;s++){var c=/^\s*\[([A-Za-z]+)\s*"(.*)"\s*\]\s*$/;p=a[s].replace(c,"$1"),i=a[s].replace(c,"$2"),R(p).length>0&&(n[p]=i)}return n}(i,t),c="";for(var l in s)"fen"===l.toLowerCase()&&(c=s[l]),V([l,s[l]]);if(r){if(c&&!L(c,!0))return!1}else if(!("1"!==s.SetUp||"FEN"in s&&L(s.FEN,!0)))return!1;for(var P=function(e){return`{${function(e){return Array.from(e).map((function(e){return e.charCodeAt(0)<128?e.charCodeAt(0).toString(16):encodeURIComponent(e).replace(/\%/g,"").toLowerCase()})).join("")}((e=e.replace(new RegExp(o(a),"g")," ")).slice(1,e.length-1))}}`},h=function(e){if(e.startsWith("{")&&e.endsWith("}"))return function(e){return 0==e.length?"":decodeURIComponent("%"+e.match(/.{1,2}/g).join("%"))}(e.slice(1,e.length-1))},d=e.replace(i,"").replace(new RegExp(`({[^}]*})+?|;([^${o(a)}]*)`,"g"),(function(e,t,r){return void 0!==t?P(t):" "+P(`{${r.slice(1)}}`)})).replace(new RegExp(o(a),"g")," "),u=/(\([^\(\)]+\))+?/g;u.test(d);)d=d.replace(u,"");var f=R(d=(d=(d=d.replace(/\d+\.(\.\.)?/g,"")).replace(/\.\.\./g,"")).replace(/\$\d+/g,"")).split(new RegExp(/\s+/));f=f.join(",").replace(/,,+/g,",").split(",");for(var v="",g="",b=0;b<f.length;b++){var m=h(f[b]);if(void 0===m)if(null==(v=ne(f[b],r))){if(!(n.indexOf(f[b])>-1))return!1;g=f[b]}else g="",re(v);else F[x()]=m}return g&&Object.keys(_).length&&!_.Result&&V(["Result",g]),!0},header:function(){return V(arguments)},turn:function(){return M},move:function(e,t){var r=void 0!==t&&"sloppy"in t&&t.sloppy,o=null;if("string"==typeof e)o=ne(e,r);else if("object"==typeof e)for(var n=$(),a=0,p=n.length;a<p;a++)if(e.from===g(n[a].from)&&e.to===g(n[a].to)&&(!("promotion"in n[a])||e.promotion===n[a].promotion)){o=n[a];break}if(!o)return null;var i=ae(o);return re(o),i},undo:function(){var e=oe();return e?ae(e):null},clear:function(){return T()},put:function(e,t){return j(e,t)},get:function(e){return H(e)},ascii(){for(var e="   +------------------------+\n",r=P.a8;r<=P.h1;r++){if(0===v(r)&&(e+=" "+"87654321"[f(r)]+" |"),null==t[r])e+=" . ";else{var o=t[r].type;e+=" "+(t[r].color===E?o.toUpperCase():o.toLowerCase())+" "}r+1&136&&(e+="|\n",r+=8)}return(e+="   +------------------------+\n")+"     a  b  c  d  e  f  g  h"},remove:function(e){return function(e){var o=H(e);return t[P[e]]=null,o&&o.type===B&&(r[o.color]=k),U(x()),o}(e)},perft:function(e){return pe(e)},square_color:function(e){if(e in P){var t=P[e];return(f(t)+v(t))%2==0?"light":"dark"}return null},history:function(e){for(var t=[],r=[],o=(void 0!==e&&"verbose"in e&&e.verbose);K.length>0;)t.push(oe());for(;t.length>0;){var n=t.pop();o?r.push(ae(n)):r.push(W(n,$({legal:!0}))),re(n)}return r},get_comment:function(){return F[x()]},set_comment:function(e){F[x()]=e.replace("{","[").replace("}","]")},delete_comment:function(){var e=F[x()];return delete F[x()],e},get_comments:function(){return I(),Object.keys(F).map((function(e){return{fen:e,comment:F[e]}}))},delete_comments:function(){return I(),Object.keys(F).map((function(e){var t=F[e];return delete F[e],{fen:e,comment:t}}))}}}},344:(e,t,r)=>{r.d(t,{b:()=>a}),r(618);var o=r(842),n=r(689);class a{constructor(e){this.stockfishOrchestrator=null,this.gameAnalysis=[],this.guiHandler=e,this.analysisArray=[],this.stopped=!1,this.running=!1}clearData(){this.gameAnalysis=[],this.analysisArray=[]}calculateMoveBrilliance(e,t){if(0==t)return"gray";const r=t%2,o=this.analysisArray[this.analysisArray.length-2],a=this.analysisArray[this.analysisArray.length-1];if(!(1 in o))return"gray";const p=(a[0].CP-o[0].CP)*(r?1:-1);if(this.analysisArray.length>2){const t=this.analysisArray[this.analysisArray.length-3];if(p>-75&&(1==r&&a[0].CP>0||0==r&&a[0].CP<0)&&n.HX(t[0].FEN,o[0].FEN,a[0].FEN,e))return"brilliant"}return e==o[0].move?Math.abs(Math.abs(o[0].CP)-Math.abs(o[1].CP))>100?"great":"best":e==o[1].move&&Math.abs(Math.abs(o[0].CP)-Math.abs(o[1].CP))<100?"good":p<-200?"mistake":"gray"}sendEval(e){if(this.stopped)return;var t=e.positionEvaluation,r=(e.FENstring,e.regularMove),o=e.moveIndex;this.analysisArray.push(t);const n={},a=t[0].CP;if("mate"==t[0].cpOrMate)if(1==t[0].isCheckmated)n.CP="M0",n.evaluation=49*-a;else{console.log(a),console.log(t);const e=a>0?1:-1;n.CP="M"+a.toString(),n.evaluation=49*e}else{var p=50*(2/(1+Math.exp(-.004*a))-1);n.evaluation=p,n.CP=a}n.moveRating=this.calculateMoveBrilliance(r,o),this.gameAnalysis.push(n),console.log("gameAnalysis",JSON.stringify(this.gameAnalysis),"analsisArray",JSON.stringify(this.analysisArray),"moveArray",JSON.stringify(this.moveArray),"fenarray",JSON.stringify(this.fenArray)),this.guiHandler.updateGraph(this.gameAnalysis)}async stopAnalysis(){if(0!=this.running){for(this.stopped=!0;this.stopped;)console.log("Cekam"),await new Promise((e=>setTimeout(e,100)));this.clearData(),console.log("stopped and started new")}}async analyzePgnGame(e,t,r,n=[],a=[]){var p;await this.stopAnalysis(),n&&(this.gameAnalysis=n),a&&(this.analysisArray=a),console.log("he alredy analyzed",n,a),console.log("KURAC"),console.log("fenMoves",e),console.log("moveArray",t),this.stockfishOrchestrator&&this.stockfishOrchestrator.deleteWorker(),this.stockfishOrchestrator=await(0,o.e)(!1),this.stockfishOrchestrator.analysisOrchestrator=this,this.stockfishOrchestrator.setCallback((e=>{this.sendEval(e)})),console.log("Propusten dalje"),this.running=!0,this.moveArray=t,this.fromPerspective=r,this.fenArray=e,p=this.gameAnalysis?this.gameAnalysis.length:0,this.guiHandler.updateGraph(this.gameAnalysis);for(let r=p;r<e.length;r++){const o=e[r];if(this.stopped){console.log("nasilno stopiram");break}0==r?await this.stockfishOrchestrator.waitForRun(o,"",r):await this.stockfishOrchestrator.waitForRun(o,t[r-1].fromto,r)}console.log("gotov"),this.stopped=!1,this.running=!1}}},241:(e,t,r)=>{r.a(e,(async(e,o)=>{try{r.d(t,{Z:()=>i});var n=r(392),a=r(735),p=e([n]);n=(p.then?(await p)():p)[0];class i{constructor(){this.activeTiles=[],this.chessBoard=Chessboard2("chessground",n.W3)}clearArrows(){this.chessBoard.clearArrows()}addBestMoveArrow(e){this.chessBoard.clearArrows();const t=e.substring(0,2),r=e.substring(2,4);this.addArrowToBoard(t,r)}addArrowToBoard(e,t){const r=e+"-"+t;console.log(`NACRTAJ MI STRELICU OD ${r} DA TI NE BIH JEBAO MAMU`),this.chessBoard.addArrow(r,"small")}getChessboard(){return this.chessBoard}flipBoard(){this.chessBoard.flip(),this.flipPromotionPopup(document.getElementById("promotion_bar"))}createButton(e,t,r,o,n){const p=document.createElement("div");p.classList.add("promotion-figure-button");const i=document.createElement("img");return i.src="/img/chesspieces/wikipedia/"+n+a.D.PROMOTION_TO_CHAR[e].toUpperCase()+".png",i.id=`button-${e}`,i.addEventListener("click",(n=>this.promotionChosenCallback(n,t,r,o,e))),p.appendChild(i),p}promotionChosenCallback(e,t,r,o,n){const p=document.getElementById("promotion_bar");for(p.style.visibility="hidden";p.firstChild;)p.removeChild(p.firstChild);t(r,o,a.D.PROMOTION_TO_CHAR[n])}movePromotionPopup(e,t,r){console.log(t);const o=100*(0,n.dF)(t),a="w"==r?0:100;console.log("translate",o,a),"white"==this.chessBoard.orientation()?e.style.transform=`translate(${o}%, ${a}%)`:e.style.transform=`translate(${700-o}%, ${100-a}%)`}flipPromotionPopup(e){const t=e.style.transform,r=/translate\((\d+)%, (\d+)%\)/.exec(t);if(r){const t=parseInt(r[1]),o=parseInt(r[2]);e.style.transform=`translate(${700-t}%, ${100-o}%)`}}createPromotionPopup(e,t,r,o){console.log("PRAVIM DUGMICE");const n=document.getElementById("promotion_bar");this.movePromotionPopup(n,r,o),n.style.visibility="visible";for(let a=0;a<=3;a++){const p=this.createButton(a,e,t,r,o);n.appendChild(p)}}colorTile(e,t,r="yellow_tile"){var o=document.getElementById("chessground");const n=8-parseInt(e[1]),p=e[0].charCodeAt(0)-"a".charCodeAt(0);if(n>=0&&n<8&&p>=0&&p<8){var i=o.firstElementChild.firstElementChild.children[1].children[n].children[p];if(t==a.D.TILE_COLORS.ACTIVE){const t=i.classList[i.classList.length-1];"active"!=t&&(this.activeTiles.push(e),"inactive"==t?(i.classList.remove(t),i.classList.add(r)):i.classList.add(r))}else t==a.D.TILE_COLORS.INACTIVE&&(i.classList.remove(i.classList[i.classList.length-1]),i.classList.add("kurac"))}}deactivateTiles(){for(;this.activeTiles.length>0;)this.colorTile(this.activeTiles[this.activeTiles.length-1],a.D.TILE_COLORS.INACTIVE),this.activeTiles.pop()}}o()}catch(e){o(e)}}))},759:(e,t,r)=>{r.d(t,{Q:()=>c});var o=0;const n={id:"verticalLinePlugin",afterEvent:function(e,t){if("click"==t.event.type){const{ctx:t,tooltip:r,chartArea:{top:n,right:a,bottom:p,left:i,width:s,height:c},scales:{x:l,y:P}}=e;o=r.dataPoints[0].dataIndex,console.log(o)}},afterDatasetsDraw(e,t,r){const{ctx:n,tooltip:a,chartArea:{top:p,right:i,bottom:s,left:c,width:l,height:P},scales:{x:h,y:d}}=e,u=h.getPixelForValue(o);n.restore(),n.strokeStyle="rgba(170, 252, 255, 0.8)",n.strokeRect(u,p,0,P),n.save()}},a={id:"hoverLinePlugin",beforeDatasetsDraw(e,t,r){const{ctx:o,tooltip:n,chartArea:{top:a,right:p,bottom:i,left:s,width:c,height:l},scales:{x:P,y:h}}=e;if(n._active.length>0){const e=P.getPixelForValue(n.dataPoints[0].dataIndex);o.save(),o.strokeStyle="gray",o.strokeRect(e,a,0,l)}}};var p=r(735),i={lineAtIndex:[2,4,8],labels:[],datasets:[{label:"Data",data:[],lineTension:0,fill:{above:"rgba(255, 255, 255, 0.8)",below:"rgba(0, 0, 0, 0.8)",target:{value:0}},borderWidth:0,pointHitRadius:50,usePointStyle:!0,pointStyle:"circle",pointRadius:[],hoverRadius:5,hoverBorderWidth:0,borderColor:"rgba(170, 252, 255, 0.8)"}]},s=[];class c{constructor(e){this.chartData=i,this.canvasId=e,this.gameAnalysis=null;const t=document.getElementById(e);this.graph=new Chart(t,{type:"line",data:this.chartData,plugins:[n,a],options:{pointBackgroundColor:e=>{const t=e.dataIndex;try{return p.D.Colors[this.gameAnalysis[t].moveRating]}catch(e){return"gray"}},plugins:{legend:{display:!1},verticalLinePlugin:{lineColor:"cyan",xPosition:3},tooltip:{bodySpacing:0,displayColors:!1,callbacks:{title:function(e,t){return""},body:function(e){return"k"},label:function(e){return s[e.dataIndex].CP.toString()}}}},responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},scales:{y:{min:-50,max:50,ticks:{display:!1}},x:{ticks:{display:!1}}},onClick:e=>{const t=Chart.helpers.getRelativePosition(e,this.graph),r=this.graph.scales.x.getValueForPixel(t.x),o=this.graph.scales.y.getValueForPixel(t.y);console.log(r,o),this.playerControllerInst.gotoMove(r)}}})}clearData(){this.gameAnalysis=[],s=[],this.chartData.labels=[],this.chartData.datasets[0].data=[],this.chartData.datasets[0].pointRadius=[],this.graph.update()}updateGraph(e){this.gameAnalysis=e,s=e;var t=this.chartData.labels=[],r=this.chartData.datasets[0].data=[],o=this.chartData.datasets[0].pointRadius=[];for(const e of this.gameAnalysis)t.push(e.CP.toString()),r.push(e.evaluation),o.push(p.D.pointSizes[e.moveRating]);this.graph.update()}updateGraphSelectedMove(e){!function(e){o=e}(e),this.graph.update()}}},307:(e,t,r)=>{r.a(e,(async(e,o)=>{try{r.d(t,{C:()=>s});var n=r(989),a=r(735),p=r(241),i=e([p]);p=(i.then?(await i)():i)[0];class s{constructor(e,t){this.soundHandler=new n.F,this.evaluationGraph=e,this.chessboardHandler=new p.Z,this.sidebar=t,this.boardOrientation="white"}getSidebar(){return this.sidebar}getGameAnalysis(){return this.gameAnalysis}setBoardOrientation(e){this.boardOrientation!=e&&this.flipBoard()}clearData(){this.gameAnalysis=[],this.evaluationGraph.clearData()}showImportPopup(){console.log("Vsiible"),document.getElementById("import_popup").style.visibility="visible"}hideImportPopup(){document.getElementById("import_popup").style.visibility="hidden"}clearArrows(){this.chessboardHandler.clearArrows()}addBestMoveArrow(e){this.chessboardHandler.addBestMoveArrow(e)}addArrowToBoard(e,t){this.chessboardHandler.addArrowToBoard(e,t)}getChessboard(){return this.chessboardHandler.getChessboard()}flipBoard(){"white"==this.boardOrientation?this.boardOrientation="black":this.boardOrientation="white",this.sidebar.setCounterOrientation(this.boardOrientation),this.chessboardHandler.flipBoard()}createPromotionPopup(e,t,r,o){this.chessboardHandler.createPromotionPopup(e,t,r,o)}colorTile(e,t,r="yellow_tile"){this.chessboardHandler.colorTile(e,t,r)}deactivateTiles(){this.chessboardHandler.deactivateTiles()}colorTilesForMove(e,t,r){if(this.deactivateTiles(),""!=e&&""!=t){const o=this.gameAnalysis[r].moveRating,n=a.D.CssDictForTiles[o];this.colorTile(e,a.D.TILE_COLORS.ACTIVE,n),this.colorTile(t,a.D.TILE_COLORS.ACTIVE,n)}}async setBoardAndMove(e,t,r,o,n=a.D.MOVE_TYPE.MOVE_NONE){this.soundHandler.playSound(n),this.evaluationGraph.updateGraphSelectedMove(o),this.chessboardHandler.getChessboard().position(e,!1),this.colorTilesForMove(t,r,o)}updateGraph(e){this.sidebar.clearMoveCounter();var t=0;for(const r of e)this.addMoveAnalysis(r,t%2==0?"black":"white"),t++;this.gameAnalysis=e,this.evaluationGraph.updateGraph(e)}addMoveAnalysis(e,t){this.sidebar.addSpecialMove(e.moveRating,t)}updateSidebar(e){this.sidebar.setAnalysisData(e)}}o()}catch(e){o(e)}}))},587:(e,t,r)=>{r.a(e,(async(e,o)=>{try{r.d(t,{n:()=>p});var n=r(392),a=e([n]);n=(a.then?(await a)():a)[0];class p{constructor(e,t,r){this.stockfishOrchestrator=e,this.guiHandler=t,this.stockfishOrchestrator.setCallback((e=>{this.evaluationGetCallback(e)})),this.div=r,this.enabled=!1,this.lastFen="",document.getElementById("toggleSwitch").addEventListener("change",this.toggleSwitched.bind(this))}disableAllLines(){var e=this.div.children;for(let t=0;t<e.length;t++)e[t].style.display="none"}toggleSwitched(){this.enabled=!this.enabled,this.enabled?(console.log("LBE enabled"),this.evaulateNewBoard(this.lastFen)):(this.disableAllLines(),this.guiHandler.clearArrows())}evaluationGetCallback(e){var t=e.positionEvaluation;if(this.enabled){var r=this.div.children;let e=0;console.log(t);const a=t[0].move;for(this.guiHandler.addBestMoveArrow(a);e in t;){var o=r[e];if("none"===window.getComputedStyle(o).display&&(o.style.display="flex"),console.log(t[e]),o.querySelector(".liveBestMove").textContent=(0,n.wV)(t[e].move,t[e].FEN),"cp"==t[e].cpOrMate){const r=parseFloat(t[e].CP)/100>0;o.querySelector(".liveEvaluation").textContent=(r?"+":"")+(parseFloat(t[e].CP)/100).toString()}else o.querySelector(".liveEvaluation").textContent="M"+t[e].CP;e++}}}evaulateNewBoard(e){this.lastFen=e,this.enabled&&""!=e&&this.stockfishOrchestrator.stopAndStartNewAnalysis(e)}}o()}catch(e){o(e)}}))},180:(e,t,r)=>{r.a(e,(async(e,o)=>{try{r.d(t,{Z:()=>c});var n=r(689),a=r(618),p=r(735),i=r(392),s=e([i]);i=(s.then?(await s)():s)[0];class c{constructor(e,t,r){this.liveBoardEvaluation=r,this.currentPgn=null,this.analysisOrchestrator=t,this.guiHandler=e,this.currentMove=0,this.mainChessObject=(0,a.qQ)(),this.alternativeChessObject=(0,a.qQ)(),this.alternativeStackLeft=[],this.alternativeStackRight=[],this.inAlternativePath=!1,this.liveBoardEvaluation=r,this.analysisData=[],this.analyzedFens=[],this.ready=!1}getMoveType(e){return"c"==e?p.D.MOVE_TYPE.MOVE_CAPTURE:p.D.MOVE_TYPE.MOVE_REGULAR}gotoMoveOfType(e,t){console.log("tryna go to move of type",t,e);const r=this.currentMove+(this.currentMove%2==0&&e||this.currentMove%2==1&&!e?1:0);var o=r;for(o+2>=this.currentMoveArray.length?o=1+(e?0:1):o+=2,console.log(this.guiHandler.getGameAnalysis());o!=r;){if(this.guiHandler.getGameAnalysis()[o].moveRating==t)return void this.gotoMove(o);o+2>=this.currentMoveArray.length?o=1+(e?0:1):o+=2}}moveArrayToPgn(e){var t=(0,a.qQ)();for(const r of e)console.log(r.san),t.move(r.san);return console.log(t.pgn()),t.pgn()}setGameFromExtension(e,t,r,o,n,a=!1){if(console.log("injector tried to call me",this.ready,e,t),a||this.ready){this.currentFenArray=e,this.currentMoveArray=t,this.analysisData=r,this.analyzedFens=o,this.playerSide=n;const a=this.moveArrayToPgn(t);return this.guiHandler.setBoardOrientation(n),this.guiHandler.updateSidebar(a),this.startAnalysis(),!0}return!1}setPgn(e){this.analysisData=[],this.analyzedFens=[],this.currentPgn=e,this.currentFenArray=(0,n.FB)(this.currentPgn),this.currentMoveArray=(0,n.QZ)(this.currentPgn),this.guiHandler.updateSidebar(e),this.gotoMove(0),this.guiHandler.clearData(),this.startAnalysis()}getChessObject(){return this.inAlternativePath?this.alternativeChessObject:this.mainChessObject}getAlternativeChessObject(){return this.alternativeChessObject}getInAlternative(){return this.inAlternativePath}startAnalysis(){this.analysisOrchestrator.analyzePgnGame(this.currentFenArray,this.currentMoveArray,this.playerSide,this.analysisData,this.analyzedFens)}updateBoardGUI(e,t,r,o,n){this.guiHandler.setBoardAndMove(e,t,r,o,n),this.liveBoardEvaluation.evaulateNewBoard(e)}makeAlternativeMove(e,t){const r=e.substring(0,2),o=e.substring(2,4),n=this.alternativeChessObject.move({from:r,to:o,promotion:t});if(console.log(n,e,this.alternativeChessObject.fen()),!n)return"snapback";{const n=this.alternativeChessObject.fen();this.inAlternativePath=!0,this.updateBoardGUI(n,r,o,this.currentMove,p.D.MOVE_TYPE.MOVE_REGULAR),this.alternativeStackLeft.push([e,t])}}makePossibleAlternativeMove(e,t){var r;return this.guiHandler.getChessboard().clearCircles(),this.currentMove>=this.currentMoveArray.length?this.inAlternativePath=!0:r=this.currentMoveArray[this.currentMove].from+this.currentMoveArray[this.currentMove].to,1==this.inAlternativePath||e!=r?this.makeAlternativeMove(e,t):void this.gotoMove(this.currentMove+1)}goBackwards(){if(this.inAlternativePath){const e=this.alternativeStackLeft.pop();this.alternativeStackRight.push(e);const t=e[0].substring(0,2),r=e[0].substring(2,4);this.alternativeChessObject.undo(),this.guiHandler.setBoardAndMove(this.alternativeChessObject.fen(),t,r,this.currentMove,p.D.MOVE_TYPE.MOVE_REGULAR),this.alternativeChessObject.fen()==this.mainChessObject.fen()&&(this.inAlternativePath=!1)}else this.gotoMove(this.currentMove-1)}goForwards(){if(this.inAlternativePath){if(this.alternativeStackRight.length>0){const e=this.alternativeStackRight.pop();this.makePossibleAlternativeMove(e[0],e[1])}}else this.gotoMove(this.currentMove+1)}gotoMove(e){if(console.log("going to move",e),this.inAlternativePath=!1,e=(0,i.mY)(e,0,this.currentMoveArray.length),this.currentMove=e,this.mainChessObject.load(this.currentFenArray[e]),this.alternativeChessObject.load(this.currentFenArray[e]),e>0){console.log(this.currentFenArray[e]);const t=this.currentMoveArray[e-1].flags,r=this.getMoveType(t);this.updateBoardGUI(this.currentFenArray[e],this.currentMoveArray[e-1].fromto.substring(0,2),this.currentMoveArray[e-1].fromto.substring(2,4),e,r)}else this.updateBoardGUI(this.currentFenArray[e],"","",e,p.D.MOVE_TYPE.MOVE_REGULAR)}}o()}catch(e){o(e)}}))},337:(e,t,r)=>{r.d(t,{Y:()=>a});var o=r(618),n=r(735);class a{constructor(e){this.div=e,this.playerSide="white",document.getElementById("flipBoardButton").addEventListener("click",(()=>{this.guiHandler.flipBoard()})),document.getElementById("loadpgnButton").addEventListener("click",(()=>{this.guiHandler.showImportPopup()})),document.getElementById("import-button").addEventListener("click",(()=>{this.importFromText()})),document.getElementById("close-import-button").addEventListener("click",(()=>{this.guiHandler.hideImportPopup()}));const t=document.getElementById("moveOverviewDiv");n.D.MOVE_NAMES.forEach((e=>{var r=document.createElement("div");r.className="moveOverview "+n.D.MOVE_TO_ID_NAME[e];var o=document.createElement("span");o.textContent="0",o.id="white-"+n.D.MOVE_TO_ID_NAME[e],o.addEventListener("click",(e=>this.gotoSpecialMove(e)));var a=document.createElement("div");a.textContent=e;var p=document.createElement("span");p.textContent="0",p.id="black-"+n.D.MOVE_TO_ID_NAME[e],p.addEventListener("click",(e=>this.gotoSpecialMove(e))),r.append(o),r.append(a),r.append(p),t.append(r)}))}setCounterOrientation(e){if(this.playerSide!=e){this.playerSide=e;const t=document.getElementById("moveOverviewDiv");"reversed"==t.className?t.className="":t.className="reversed"}}gotoSpecialMove(e){const t=e.target.id;this.playerController.gotoMoveOfType("white"==t.substring(0,5),n.D.ID_NAME_TO_MOVE_RATING[t.slice(6)]),console.log("tried to go to move",e.target.id)}addSpecialMove(e,t){const r=n.D.MOVE_RATING_TO_ID_NAME[e];console.log("wanna add special move ",e,t+"-"+r);const o=document.getElementById(t+"-"+r);o&&(o.textContent=(parseInt(o.textContent)+1).toString())}clearMoveCounter(){document.getElementById("moveOverviewDiv").querySelectorAll("span").forEach((e=>{e.textContent="0"}))}importFromText(){const e=document.getElementById("pgn_textarea").value;this.guiHandler.hideImportPopup(),this.playerController.setPgn(e)}setAnalysisData(e){console.log("SETUP");const t=e=>{this.playerController.gotoMove(parseInt(e.target.id)+1)},r=(e,r,o)=>{const n=document.createElement("div");n.id=`${e+1}`,n.textContent=""+(e+1)/2,n.className="move-element";const a=document.createElement("div");if(a.className="move-notation clickable",a.textContent=r,a.id=""+(e-1),a.addEventListener("click",t),n.appendChild(a),""!=o){const r=document.createElement("div");r.className="move-notation clickable",r.textContent=o,r.id=`${e}`,r.addEventListener("click",t),n.appendChild(r)}return n};for(;this.div.firstChild;)this.div.removeChild(this.div.firstChild);const n=function(e){const t=(0,o.qQ)();t.load_pgn(e);const r=t.history();var n=[];return r.forEach(((e,t)=>{n.push(e)})),n}(e);var a=[];if(n.forEach(((e,t)=>{if(a.push(e),2==a.length){const e=r(t,a[0],a[1]);this.div.appendChild(e),a=[]}})),1==a.length){const e=r(n.length,a[0],"");this.div.appendChild(e)}}}},989:(e,t,r)=>{r.d(t,{F:()=>a});var o=r(735);async function n(e){const t=await fetch(e);return await t.blob()}class a{constructor(){this.audioArray=Array(4).fill(void 0),n("/assets/audio/standard/Move.mp3").then((e=>{this.audioArray[o.D.MOVE_TYPE.MOVE_REGULAR]=URL.createObjectURL(e)})),n("/assets/audio/standard/Capture.mp3").then((e=>{this.audioArray[o.D.MOVE_TYPE.MOVE_CAPTURE]=URL.createObjectURL(e)})),n("/assets/audio/standard/Check.mp3").then((e=>{this.audioArray[o.D.MOVE_TYPE.MOVE_CHECK]=URL.createObjectURL(e)})),n("/assets/audio/standard/Victory.mp3").then((e=>{this.audioArray[o.D.MOVE_TYPE.MOVE_MATE]=URL.createObjectURL(e)}))}enableSound(){this.enabled=!0}disableSound(){this.enabled=!1}playSound(e){if(e!=o.D.MOVE_TYPE.MOVE_NONE){let t=new Audio(this.audioArray[e]);t.volume=.5,t.play()}}}},735:(e,t,r)=>{var o;r.d(t,{D:()=>o}),function(e){let t,r,o,n;e.STOCKFISH_MOVETIME=1500,function(e){e[e.MOVE_REGULAR=0]="MOVE_REGULAR",e[e.MOVE_CAPTURE=1]="MOVE_CAPTURE",e[e.MOVE_CHECK=2]="MOVE_CHECK",e[e.MOVE_MATE=3]="MOVE_MATE",e[e.MOVE_NONE=4]="MOVE_NONE"}(t=e.MOVE_TYPE||(e.MOVE_TYPE={})),function(e){e[e.ACTIVE=0]="ACTIVE",e[e.INACTIVE=1]="INACTIVE"}(r=e.TILE_COLORS||(e.TILE_COLORS={})),function(e){e[e.WHITE=0]="WHITE",e[e.BLACK=1]="BLACK",e[e.BOTH=2]="BOTH"}(o=e.ANALYSIS_FOR||(e.ANALYSIS_FOR={})),e.MOVE_NAMES=["Brilliant","Great Move","Best Move"],e.MOVE_TO_ID_NAME={Brilliant:"brilliant-color","Great Move":"great-color","Best Move":"best-color"},e.ID_NAME_TO_MOVE_RATING={"brilliant-color":"brilliant","great-color":"great","best-color":"best"},e.MOVE_RATING_TO_ID_NAME={brilliant:"brilliant-color",great:"great-color",best:"best-color"},e.Colors={brilliant:"rgba(15, 255, 243, 1)",great:"rgba(107, 111, 229, 1)",best:"gray",good:"gray",gray:"gray",mistake:"red"},e.CssDictForTiles={brilliant:"brilliant_tile",great:"great_tile",best:"yellow_tile",good:"yellow_tile",gray:"yellow_tile",mistake:"mistake_tile"},e.pointSizes={brilliant:3,great:3,best:1,good:1,gray:1,mistake:1},function(e){e[e.QUEEN=0]="QUEEN",e[e.ROOK=1]="ROOK",e[e.BISHOP=2]="BISHOP",e[e.KNIGHT=3]="KNIGHT"}(n=e.PROMOTION||(e.PROMOTION={})),e.PROMOTION_TO_CHAR={0:"q",1:"r",2:"n",3:"b"},e.PROMOTION_CHAR_TO_IMAGE_URL={q:"/img/chesspieces/wikipedia/bQ.png",r:"/img/chesspieces/wikipedia/bR.png",n:"/img/chesspieces/wikipedia/bN.png",b:"/img/chesspieces/wikipedia/bB.png"}}(o||(o={}))},824:(e,t,r)=>{r.a(e,(async(e,o)=>{try{r.d(t,{sV:()=>v,tQ:()=>m});var n=r(344),a=r(401),p=r(759),i=r(307),s=r(180),c=r(337),l=r(842),P=r(587),h=e([i,s,P]);[i,s,P]=h.then?(await h)():h;const u=new c.Y(document.getElementById("sidebarComponent")),f=new p.Q("myChart"),v=new i.C(f,u);var d=new n.b(v);const g=await(0,l.e)(!0),b=new P.n(g,v,document.getElementById("liveEvaluationContainer")),m=new s.Z(v,d,b);u.playerController=m,u.guiHandler=v,console.log("playerControllerSet"),document.addEventListener("keydown",(function(e){37===e.keyCode?m.goBackwards():39===e.keyCode&&m.goForwards()})),f.playerControllerInst=m,window.playerControllerInst=m,console.log("KURAC"),console.log(m.ready),console.log(window.location.href,"https://chessvanced.com/","https://chessvanced.com/"==window.location.href),("https://www.chessvanced.com/"==window.location.href||"https://chessvanced.com/"==window.location.href||"http://localhost:8000/"==window.location.href)&&m.setGameFromExtension(a.w$,a.MK,a.T5,a.uL,"black",!0),m.ready=!0,console.log("successfully finished connectStockfish",window.location.href),o()}catch(e){o(e)}}),1)},401:(e,t,r)=>{r.d(t,{MK:()=>a,T5:()=>n,uL:()=>o,w$:()=>p});const o=JSON.parse('[{"0":{"move":"g1f3","CP":75,"cpOrMate":"cp","FEN":"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1","depth":21},"1":{"move":"d2d4","CP":67,"cpOrMate":"cp","FEN":"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1","depth":21}},{"0":{"move":"e7e6","CP":-15,"cpOrMate":"cp","FEN":"rnbqkbnr/pppppppp/8/8/4P3/8/PPPP1PPP/RNBQKBNR b KQkq e3 0 1","depth":20},"1":{"move":"e7e5","CP":14,"cpOrMate":"cp","FEN":"rnbqkbnr/pppppppp/8/8/4P3/8/PPPP1PPP/RNBQKBNR b KQkq e3 0 1","depth":20}},{"0":{"move":"g1f3","CP":77,"cpOrMate":"cp","FEN":"rnbqkbnr/pppp1ppp/8/4p3/4P3/8/PPPP1PPP/RNBQKBNR w KQkq e6 0 2","depth":21},"1":{"move":"b1c3","CP":52,"cpOrMate":"cp","FEN":"rnbqkbnr/pppp1ppp/8/4p3/4P3/8/PPPP1PPP/RNBQKBNR w KQkq e6 0 2","depth":20}},{"0":{"move":"d7d6","CP":17,"cpOrMate":"cp","FEN":"rnbqkbnr/pppp1ppp/8/4p3/4P3/5N2/PPPP1PPP/RNBQKB1R b KQkq - 1 2","depth":20},"1":{"move":"b8c6","CP":35,"cpOrMate":"cp","FEN":"rnbqkbnr/pppp1ppp/8/4p3/4P3/5N2/PPPP1PPP/RNBQKB1R b KQkq - 1 2","depth":20}},{"0":{"move":"f1b5","CP":73,"cpOrMate":"cp","FEN":"r1bqkbnr/pppp1ppp/2n5/4p3/4P3/5N2/PPPP1PPP/RNBQKB1R w KQkq - 2 3","depth":20},"1":{"move":"f1c4","CP":55,"cpOrMate":"cp","FEN":"r1bqkbnr/pppp1ppp/2n5/4p3/4P3/5N2/PPPP1PPP/RNBQKB1R w KQkq - 2 3","depth":20}},{"0":{"move":"d7d6","CP":5,"cpOrMate":"cp","FEN":"r1bqkbnr/pppp1ppp/2n5/4p3/2B1P3/5N2/PPPP1PPP/RNBQK2R b KQkq - 3 3","depth":19},"1":{"move":"g8f6","CP":25,"cpOrMate":"cp","FEN":"r1bqkbnr/pppp1ppp/2n5/4p3/2B1P3/5N2/PPPP1PPP/RNBQK2R b KQkq - 3 3","depth":19}},{"0":{"move":"c2c3","CP":79,"cpOrMate":"cp","FEN":"r1bqk1nr/pppp1ppp/2n5/2b1p3/2B1P3/5N2/PPPP1PPP/RNBQK2R w KQkq - 4 4","depth":21},"1":{"move":"e1g1","CP":56,"cpOrMate":"cp","FEN":"r1bqk1nr/pppp1ppp/2n5/2b1p3/2B1P3/5N2/PPPP1PPP/RNBQK2R w KQkq - 4 4","depth":20}},{"0":{"move":"c5b4","CP":-91,"cpOrMate":"cp","FEN":"r1bqk1nr/pppp1ppp/2n5/2b1p3/1PB1P3/5N2/P1PP1PPP/RNBQK2R b KQkq b3 0 4","depth":19},"1":{"move":"c5b6","CP":7,"cpOrMate":"cp","FEN":"r1bqk1nr/pppp1ppp/2n5/2b1p3/1PB1P3/5N2/P1PP1PPP/RNBQK2R b KQkq b3 0 4","depth":19}},{"0":{"move":"c2c3","CP":-29,"cpOrMate":"cp","FEN":"r1bqk1nr/pppp1ppp/2n5/4p3/1bB1P3/5N2/P1PP1PPP/RNBQK2R w KQkq - 0 5","depth":20},"1":{"move":"e1g1","CP":-61,"cpOrMate":"cp","FEN":"r1bqk1nr/pppp1ppp/2n5/4p3/1bB1P3/5N2/P1PP1PPP/RNBQK2R w KQkq - 0 5","depth":20}},{"0":{"move":"b4a5","CP":-45,"cpOrMate":"cp","FEN":"r1bqk1nr/pppp1ppp/2n5/4p3/1bB1P3/2P2N2/P2P1PPP/RNBQK2R b KQkq - 0 5","depth":20},"1":{"move":"b4d6","CP":-32,"cpOrMate":"cp","FEN":"r1bqk1nr/pppp1ppp/2n5/4p3/1bB1P3/2P2N2/P2P1PPP/RNBQK2R b KQkq - 0 5","depth":19}},{"0":{"move":"d2d4","CP":0,"cpOrMate":"cp","FEN":"r1bqk1nr/pppp1ppp/2n5/b3p3/2B1P3/2P2N2/P2P1PPP/RNBQK2R w KQkq - 1 6","depth":20},"1":{"move":"e1g1","CP":-9,"cpOrMate":"cp","FEN":"r1bqk1nr/pppp1ppp/2n5/b3p3/2B1P3/2P2N2/P2P1PPP/RNBQK2R w KQkq - 1 6","depth":20}},{"0":{"move":"d7d6","CP":-65,"cpOrMate":"cp","FEN":"r1bqk1nr/pppp1ppp/2n5/b3p3/2B1P3/2P2N2/P2P1PPP/RNBQ1RK1 b kq - 2 6","depth":22},"1":{"move":"g8f6","CP":-64,"cpOrMate":"cp","FEN":"r1bqk1nr/pppp1ppp/2n5/b3p3/2B1P3/2P2N2/P2P1PPP/RNBQ1RK1 b kq - 2 6","depth":22}},{"0":{"move":"d2d4","CP":0,"cpOrMate":"cp","FEN":"r1bqk2r/pppp1ppp/2n2n2/b3p3/2B1P3/2P2N2/P2P1PPP/RNBQ1RK1 w kq - 3 7","depth":21},"1":{"move":"d1c2","CP":-83,"cpOrMate":"cp","FEN":"r1bqk2r/pppp1ppp/2n2n2/b3p3/2B1P3/2P2N2/P2P1PPP/RNBQ1RK1 w kq - 3 7","depth":21}},{"0":{"move":"e5d4","CP":-73,"cpOrMate":"cp","FEN":"r1bqk2r/pppp1ppp/2n2n2/b3p3/2BPP3/2P2N2/P4PPP/RNBQ1RK1 b kq d3 0 7","depth":22},"1":{"move":"d7d6","CP":-56,"cpOrMate":"cp","FEN":"r1bqk2r/pppp1ppp/2n2n2/b3p3/2BPP3/2P2N2/P4PPP/RNBQ1RK1 b kq d3 0 7","depth":22}},{"0":{"move":"c1a3","CP":-48,"cpOrMate":"cp","FEN":"r1bqk2r/pppp1ppp/2n2n2/b7/2BpP3/2P2N2/P4PPP/RNBQ1RK1 w kq - 0 8","depth":20},"1":{"move":"e4e5","CP":-56,"cpOrMate":"cp","FEN":"r1bqk2r/pppp1ppp/2n2n2/b7/2BpP3/2P2N2/P4PPP/RNBQ1RK1 w kq - 0 8","depth":20}},{"0":{"move":"d7d6","CP":-126,"cpOrMate":"cp","FEN":"r1bqk2r/pppp1ppp/2n2n2/b7/2BPP3/5N2/P4PPP/RNBQ1RK1 b kq - 0 8","depth":20},"1":{"move":"f6e4","CP":-89,"cpOrMate":"cp","FEN":"r1bqk2r/pppp1ppp/2n2n2/b7/2BPP3/5N2/P4PPP/RNBQ1RK1 b kq - 0 8","depth":20}},{"0":{"move":"d4d5","CP":-77,"cpOrMate":"cp","FEN":"r1bqk2r/pppp1ppp/2n5/b7/2BPn3/5N2/P4PPP/RNBQ1RK1 w kq - 0 9","depth":21},"1":{"move":"b1d2","CP":-109,"cpOrMate":"cp","FEN":"r1bqk2r/pppp1ppp/2n5/b7/2BPn3/5N2/P4PPP/RNBQ1RK1 w kq - 0 9","depth":21}},{"0":{"move":"c6e7","CP":-110,"cpOrMate":"cp","FEN":"r1bqk2r/pppp1ppp/2n5/b2P4/2B1n3/5N2/P4PPP/RNBQ1RK1 b kq - 0 9","depth":21},"1":{"move":"c6b8","CP":7,"cpOrMate":"cp","FEN":"r1bqk2r/pppp1ppp/2n5/b2P4/2B1n3/5N2/P4PPP/RNBQ1RK1 b kq - 0 9","depth":21}},{"0":{"move":"b1d2","CP":150,"cpOrMate":"cp","FEN":"rnbqk2r/pppp1ppp/8/b2P4/2B1n3/5N2/P4PPP/RNBQ1RK1 w kq - 1 10","depth":22},"1":{"move":"c1a3","CP":47,"cpOrMate":"cp","FEN":"rnbqk2r/pppp1ppp/8/b2P4/2B1n3/5N2/P4PPP/RNBQ1RK1 w kq - 1 10","depth":22}},{"0":{"move":"e4f6","CP":-140,"cpOrMate":"cp","FEN":"rnbqk2r/pppp1ppp/8/b2P4/2BQn3/5N2/P4PPP/RNB2RK1 b kq - 2 10","depth":22},"1":{"move":"f7f5","CP":54,"cpOrMate":"cp","FEN":"rnbqk2r/pppp1ppp/8/b2P4/2BQn3/5N2/P4PPP/RNB2RK1 b kq - 2 10","depth":22}},{"0":{"move":"d5d6","CP":-54,"cpOrMate":"cp","FEN":"rnbqk2r/pppp1ppp/5n2/b2P4/2BQ4/5N2/P4PPP/RNB2RK1 w kq - 3 11","depth":21},"1":{"move":"d4e3","CP":-86,"cpOrMate":"cp","FEN":"rnbqk2r/pppp1ppp/5n2/b2P4/2BQ4/5N2/P4PPP/RNB2RK1 w kq - 3 11","depth":20}},{"0":{"move":"b7b6","CP":-166,"cpOrMate":"cp","FEN":"rnbqk2r/pppp1ppp/5n2/b1QP4/2B5/5N2/P4PPP/RNB2RK1 b kq - 4 11","depth":20},"1":{"move":"c7c6","CP":-29,"cpOrMate":"cp","FEN":"rnbqk2r/pppp1ppp/5n2/b1QP4/2B5/5N2/P4PPP/RNB2RK1 b kq - 4 11","depth":19}},{"0":{"move":"c5a5","CP":329,"cpOrMate":"cp","FEN":"rnbqk2r/ppp2ppp/3p1n2/b1QP4/2B5/5N2/P4PPP/RNB2RK1 w kq - 0 12","depth":20},"1":{"move":"c5e3","CP":-86,"cpOrMate":"cp","FEN":"rnbqk2r/ppp2ppp/3p1n2/b1QP4/2B5/5N2/P4PPP/RNB2RK1 w kq - 0 12","depth":19}},{"0":{"move":"e8g8","CP":320,"cpOrMate":"cp","FEN":"rnbqk2r/ppp2ppp/3p1n2/Q2P4/2B5/5N2/P4PPP/RNB2RK1 b kq - 0 12","depth":19},"1":{"move":"e8f8","CP":473,"cpOrMate":"cp","FEN":"rnbqk2r/ppp2ppp/3p1n2/Q2P4/2B5/5N2/P4PPP/RNB2RK1 b kq - 0 12","depth":19}},{"0":{"move":"c1b2","CP":350,"cpOrMate":"cp","FEN":"rnbq1rk1/ppp2ppp/3p1n2/Q2P4/2B5/5N2/P4PPP/RNB2RK1 w - - 1 13","depth":21},"1":{"move":"a5d2","CP":333,"cpOrMate":"cp","FEN":"rnbq1rk1/ppp2ppp/3p1n2/Q2P4/2B5/5N2/P4PPP/RNB2RK1 w - - 1 13","depth":20}},{"0":{"move":"b8d7","CP":271,"cpOrMate":"cp","FEN":"rnbq1rk1/ppp2ppp/3p1n2/Q2P2B1/2B5/5N2/P4PPP/RN3RK1 b - - 2 13","depth":20},"1":{"move":"h7h6","CP":294,"cpOrMate":"cp","FEN":"rnbq1rk1/ppp2ppp/3p1n2/Q2P2B1/2B5/5N2/P4PPP/RN3RK1 b - - 2 13","depth":20}},{"0":{"move":"g5f6","CP":320,"cpOrMate":"cp","FEN":"rnbq1rk1/ppp2pp1/3p1n1p/Q2P2B1/2B5/5N2/P4PPP/RN3RK1 w - - 0 14","depth":21},"1":{"move":"g5h4","CP":324,"cpOrMate":"cp","FEN":"rnbq1rk1/ppp2pp1/3p1n1p/Q2P2B1/2B5/5N2/P4PPP/RN3RK1 w - - 0 14","depth":20}},{"0":{"move":"c8f5","CP":273,"cpOrMate":"cp","FEN":"rnbq1rk1/ppp2pp1/3p1n1p/Q2P4/2B4B/5N2/P4PPP/RN3RK1 b - - 1 14","depth":21},"1":{"move":"c8g4","CP":279,"cpOrMate":"cp","FEN":"rnbq1rk1/ppp2pp1/3p1n1p/Q2P4/2B4B/5N2/P4PPP/RN3RK1 b - - 1 14","depth":21}},{"0":{"move":"f3g5","CP":370,"cpOrMate":"cp","FEN":"rnbq1rk1/ppp2p2/3p1n1p/Q2P2p1/2B4B/5N2/P4PPP/RN3RK1 w - g6 0 15","depth":21},"1":{"move":"h4g3","CP":332,"cpOrMate":"cp","FEN":"rnbq1rk1/ppp2p2/3p1n1p/Q2P2p1/2B4B/5N2/P4PPP/RN3RK1 w - g6 0 15","depth":21}},{"0":{"move":"h6g5","CP":414,"cpOrMate":"cp","FEN":"rnbq1rk1/ppp2p2/3p1n1p/Q2P2N1/2B4B/8/P4PPP/RN3RK1 b - - 0 15","depth":21},"1":{"move":"b7b6","CP":546,"cpOrMate":"cp","FEN":"rnbq1rk1/ppp2p2/3p1n1p/Q2P2N1/2B4B/8/P4PPP/RN3RK1 b - - 0 15","depth":20}},{"0":{"move":"h4g5","CP":374,"cpOrMate":"cp","FEN":"rnbq1rk1/ppp2p2/3p1n2/Q2P2p1/2B4B/8/P4PPP/RN3RK1 w - - 0 16","depth":21},"1":{"move":"h4g3","CP":-18,"cpOrMate":"cp","FEN":"rnbq1rk1/ppp2p2/3p1n2/Q2P2p1/2B4B/8/P4PPP/RN3RK1 w - - 0 16","depth":21}},{"0":{"move":"f8e8","CP":364,"cpOrMate":"cp","FEN":"rnbq1rk1/ppp2p2/3p1n2/Q2P2B1/2B5/8/P4PPP/RN3RK1 b - - 0 16","depth":23},"1":{"move":"c8f5","CP":348,"cpOrMate":"cp","FEN":"rnbq1rk1/ppp2p2/3p1n2/Q2P2B1/2B5/8/P4PPP/RN3RK1 b - - 0 16","depth":22}},{"0":{"move":"b1d2","CP":400,"cpOrMate":"cp","FEN":"rn1q1rk1/ppp2p2/3p1n2/Q2P1bB1/2B5/8/P4PPP/RN3RK1 w - - 1 17","depth":22},"1":{"move":"f1e1","CP":363,"cpOrMate":"cp","FEN":"rn1q1rk1/ppp2p2/3p1n2/Q2P1bB1/2B5/8/P4PPP/RN3RK1 w - - 1 17","depth":22}},{"0":{"move":"d8f6","CP":88,"cpOrMate":"cp","FEN":"rn1q1rk1/ppp2p2/3p1B2/Q2P1b2/2B5/8/P4PPP/RN3RK1 b - - 0 17","depth":20},"1":{"move":"d8c8","CP":814,"cpOrMate":"cp","FEN":"rn1q1rk1/ppp2p2/3p1B2/Q2P1b2/2B5/8/P4PPP/RN3RK1 b - - 0 17","depth":19}},{"0":{"move":"b1a3","CP":126,"cpOrMate":"cp","FEN":"rn3rk1/ppp2p2/3p1q2/Q2P1b2/2B5/8/P4PPP/RN3RK1 w - - 0 18","depth":19},"1":{"move":"b1d2","CP":108,"cpOrMate":"cp","FEN":"rn3rk1/ppp2p2/3p1q2/Q2P1b2/2B5/8/P4PPP/RN3RK1 w - - 0 18","depth":18}},{"0":{"move":"c7c5","CP":64,"cpOrMate":"cp","FEN":"rn3rk1/ppp2p2/3p1q2/Q2P1b2/2B5/8/P2N1PPP/R4RK1 b - - 1 18","depth":19},"1":{"move":"b8d7","CP":94,"cpOrMate":"cp","FEN":"rn3rk1/ppp2p2/3p1q2/Q2P1b2/2B5/8/P2N1PPP/R4RK1 b - - 1 18","depth":19}},{"0":{"move":"a1e1","CP":166,"cpOrMate":"cp","FEN":"rn3r1k/ppp2p2/3p1q2/Q2P1b2/2B5/8/P2N1PPP/R4RK1 w - - 2 19","depth":19},"1":{"move":"f1e1","CP":116,"cpOrMate":"cp","FEN":"rn3r1k/ppp2p2/3p1q2/Q2P1b2/2B5/8/P2N1PPP/R4RK1 w - - 2 19","depth":19}},{"0":{"move":"b8d7","CP":79,"cpOrMate":"cp","FEN":"rn3r1k/ppQ2p2/3p1q2/3P1b2/2B5/8/P2N1PPP/R4RK1 b - - 0 19","depth":21},"1":{"move":"f8g8","CP":110,"cpOrMate":"cp","FEN":"rn3r1k/ppQ2p2/3p1q2/3P1b2/2B5/8/P2N1PPP/R4RK1 b - - 0 19","depth":21}},{"0":{"move":"a1d1","CP":161,"cpOrMate":"cp","FEN":"rn4rk/ppQ2p2/3p1q2/3P1b2/2B5/8/P2N1PPP/R4RK1 w - - 1 20","depth":20},"1":{"move":"g2g3","CP":129,"cpOrMate":"cp","FEN":"rn4rk/ppQ2p2/3p1q2/3P1b2/2B5/8/P2N1PPP/R4RK1 w - - 1 20","depth":20}},{"0":{"move":"f5h3","CP":-1079,"cpOrMate":"cp","FEN":"rn4rk/ppQ2p2/3p1q2/3P1b2/2B5/5N2/P4PPP/R4RK1 b - - 2 20","depth":23},"1":{"move":"f5e4","CP":-651,"cpOrMate":"cp","FEN":"rn4rk/ppQ2p2/3p1q2/3P1b2/2B5/5N2/P4PPP/R4RK1 b - - 2 20","depth":23}},{"0":{"move":"c4e2","CP":-1094,"cpOrMate":"cp","FEN":"rn4rk/ppQ2p2/3p1q2/3P4/2B5/5N1b/P4PPP/R4RK1 w - - 3 21","depth":23},"1":{"move":"f3h4","CP":-1108,"cpOrMate":"cp","FEN":"rn4rk/ppQ2p2/3p1q2/3P4/2B5/5N1b/P4PPP/R4RK1 w - - 3 21","depth":22}},{"0":{"move":"h3g2","CP":-1289,"cpOrMate":"cp","FEN":"rn4rk/ppQ2p2/3p1q2/3P4/2B5/7b/P4PPP/R3NRK1 b - - 4 21","depth":22},"1":{"move":"b8d7","CP":-686,"cpOrMate":"cp","FEN":"rn4rk/ppQ2p2/3p1q2/3P4/2B5/7b/P4PPP/R3NRK1 b - - 4 21","depth":22}},{"0":{"move":"c7c8","CP":-1274,"cpOrMate":"cp","FEN":"rn4rk/ppQ2p2/3p1q2/3P4/2B5/8/P4PbP/R3NRK1 w - - 0 22","depth":22},"1":{"move":"f2f3","CP":-12,"cpOrMate":"mate","FEN":"rn4rk/ppQ2p2/3p1q2/3P4/2B5/8/P4PbP/R3NRK1 w - - 0 22","depth":22}},{"0":{"move":"f6g5","CP":-2,"cpOrMate":"mate","FEN":"rn4rk/ppQ2p2/3p1q2/3P4/2B5/8/P4PNP/R4RK1 b - - 0 22","depth":245},"1":{"move":"f6f3","CP":-2,"cpOrMate":"mate","FEN":"rn4rk/ppQ2p2/3p1q2/3P4/2B5/8/P4PNP/R4RK1 b - - 0 22","depth":245}},{"0":{"move":"a2a3","CP":-1,"cpOrMate":"mate","FEN":"rn4rk/ppQ2p2/3p4/3P2q1/2B5/8/P4PNP/R4RK1 w - - 1 23","depth":245},"1":{"move":"f2f3","CP":-1,"cpOrMate":"mate","FEN":"rn4rk/ppQ2p2/3p4/3P2q1/2B5/8/P4PNP/R4RK1 w - - 1 23","depth":245}},{"0":{"move":"g5g2","CP":-1,"cpOrMate":"mate","FEN":"rn4rk/ppQ2p2/3p4/3P2q1/8/8/P3BPNP/R4RK1 b - - 2 23","depth":29},"1":{"move":"b8c6","CP":-96,"cpOrMate":"cp","FEN":"rn4rk/ppQ2p2/3p4/3P2q1/8/8/P3BPNP/R4RK1 b - - 2 23","depth":28}}, {"0":{"move":-1,"isCheckmated":true,"CP":1,"cpOrMate":"mate","FEN":"rn4rk/ppQ2p2/3p4/3P4/8/8/P3BPqP/R4RK1 w - - 0 24","depth":123}}]'),n=JSON.parse('[{"evaluation":7.444251681165904,"CP":75,"moveRating":"gray"},{"evaluation":-1.49955016194101,"CP":-15,"moveRating":"gray"},{"evaluation":7.639700890275547,"CP":77,"moveRating":"good"},{"evaluation":1.699345236094496,"CP":17,"moveRating":"best"},{"evaluation":7.248569538880945,"CP":73,"moveRating":"good"},{"evaluation":0.49998333399997597,"CP":5,"moveRating":"good"},{"evaluation":7.834911338823836,"CP":79,"moveRating":"gray"},{"evaluation":-9.000837522888,"CP":-91,"moveRating":"gray"},{"evaluation":-2.8967525030951844,"CP":-29,"moveRating":"best"},{"evaluation":-4.487889237358006,"CP":-45,"moveRating":"best"},{"evaluation":0,"CP":0,"moveRating":"best"},{"evaluation":-6.463629180302921,"CP":-65,"moveRating":"good"},{"evaluation":0,"CP":0,"moveRating":"good"},{"evaluation":-7.248569538880945,"CP":-73,"moveRating":"best"},{"evaluation":-4.785308556162748,"CP":-48,"moveRating":"best"},{"evaluation":-12.339888456961523,"CP":-126,"moveRating":"gray"},{"evaluation":-7.639700890275552,"CP":-77,"moveRating":"good"},{"evaluation":-10.825903074651439,"CP":-110,"moveRating":"best"},{"evaluation":14.56563062257954,"CP":150,"moveRating":"mistake"},{"evaluation":-13.645254028156634,"CP":-140,"moveRating":"mistake"},{"evaluation":-5.379102294920174,"CP":-54,"moveRating":"best"},{"evaluation":-16.015835972375736,"CP":-166,"moveRating":"gray"},{"evaluation":28.85154409609071,"CP":329,"moveRating":"mistake"},{"evaluation":28.24497764231124,"CP":320,"moveRating":"great"},{"evaluation":30.21838885585818,"CP":350,"moveRating":"great"},{"evaluation":24.725019958306905,"CP":271,"moveRating":"gray"},{"evaluation":28.24497764231124,"CP":320,"moveRating":"good"},{"evaluation":24.875814752769553,"CP":273,"moveRating":"good"},{"evaluation":31.457258070701776,"CP":370,"moveRating":"gray"},{"evaluation":33.97003196067644,"CP":414,"moveRating":"brilliant"},{"evaluation":31.697713237722212,"CP":374,"moveRating":"great"},{"evaluation":31.092012271281078,"CP":364,"moveRating":"great"},{"evaluation":33.201838513392445,"CP":400,"moveRating":"good"},{"evaluation":8.71024895421696,"CP":88,"moveRating":"mistake"},{"evaluation":12.339888456961534,"CP":126,"moveRating":"great"},{"evaluation":6.365275022536809,"CP":64,"moveRating":"good"},{"evaluation":16.015835972375736,"CP":166,"moveRating":"gray"},{"evaluation":7.834911338823836,"CP":79,"moveRating":"gray"},{"evaluation":15.565710549848433,"CP":161,"moveRating":"good"},{"evaluation":-48.682276845378354,"CP":-1079,"moveRating":"mistake"},{"evaluation":-48.75806202676917,"CP":-1094,"moveRating":"great"},{"evaluation":-49.42683289562925,"CP":-1289,"moveRating":"gray"},{"evaluation":-49.39160585245791,"CP":-1274,"moveRating":"brilliant"},{"CP":"M-2","evaluation":-49,"moveRating":"gray"},{"CP":"M-1","evaluation":-49,"moveRating":"best"},{"CP":"M-1","evaluation":-49,"moveRating":"gray"}, {"CP":"M0","evaluation":-49,"moveRating":"best"}]'),a=JSON.parse('[{"color":"w","from":"e2","to":"e4","flags":"b","piece":"p","san":"e4","fromto":"e2e4"},{"color":"b","from":"e7","to":"e5","flags":"b","piece":"p","san":"e5","fromto":"e7e5"},{"color":"w","from":"g1","to":"f3","flags":"n","piece":"n","san":"Nf3","fromto":"g1f3"},{"color":"b","from":"b8","to":"c6","flags":"n","piece":"n","san":"Nc6","fromto":"b8c6"},{"color":"w","from":"f1","to":"c4","flags":"n","piece":"b","san":"Bc4","fromto":"f1c4"},{"color":"b","from":"f8","to":"c5","flags":"n","piece":"b","san":"Bc5","fromto":"f8c5"},{"color":"w","from":"b2","to":"b4","flags":"b","piece":"p","san":"b4","fromto":"b2b4"},{"color":"b","from":"c5","to":"b4","flags":"c","piece":"b","captured":"p","san":"Bxb4","fromto":"c5b4"},{"color":"w","from":"c2","to":"c3","flags":"n","piece":"p","san":"c3","fromto":"c2c3"},{"color":"b","from":"b4","to":"a5","flags":"n","piece":"b","san":"Ba5","fromto":"b4a5"},{"color":"w","from":"e1","to":"g1","flags":"k","piece":"k","san":"O-O","fromto":"e1g1"},{"color":"b","from":"g8","to":"f6","flags":"n","piece":"n","san":"Nf6","fromto":"g8f6"},{"color":"w","from":"d2","to":"d4","flags":"b","piece":"p","san":"d4","fromto":"d2d4"},{"color":"b","from":"e5","to":"d4","flags":"c","piece":"p","captured":"p","san":"exd4","fromto":"e5d4"},{"color":"w","from":"c3","to":"d4","flags":"c","piece":"p","captured":"p","san":"cxd4","fromto":"c3d4"},{"color":"b","from":"f6","to":"e4","flags":"c","piece":"n","captured":"p","san":"Nxe4","fromto":"f6e4"},{"color":"w","from":"d4","to":"d5","flags":"n","piece":"p","san":"d5","fromto":"d4d5"},{"color":"b","from":"c6","to":"b8","flags":"n","piece":"n","san":"Nb8","fromto":"c6b8"},{"color":"w","from":"d1","to":"d4","flags":"n","piece":"q","san":"Qd4","fromto":"d1d4"},{"color":"b","from":"e4","to":"f6","flags":"n","piece":"n","san":"Nf6","fromto":"e4f6"},{"color":"w","from":"d4","to":"c5","flags":"n","piece":"q","san":"Qc5","fromto":"d4c5"},{"color":"b","from":"d7","to":"d6","flags":"n","piece":"p","san":"d6","fromto":"d7d6"},{"color":"w","from":"c5","to":"a5","flags":"c","piece":"q","captured":"b","san":"Qxa5","fromto":"c5a5"},{"color":"b","from":"e8","to":"g8","flags":"k","piece":"k","san":"O-O","fromto":"e8g8"},{"color":"w","from":"c1","to":"g5","flags":"n","piece":"b","san":"Bg5","fromto":"c1g5"},{"color":"b","from":"h7","to":"h6","flags":"n","piece":"p","san":"h6","fromto":"h7h6"},{"color":"w","from":"g5","to":"h4","flags":"n","piece":"b","san":"Bh4","fromto":"g5h4"},{"color":"b","from":"g7","to":"g5","flags":"b","piece":"p","san":"g5","fromto":"g7g5"},{"color":"w","from":"f3","to":"g5","flags":"c","piece":"n","captured":"p","san":"Nxg5","fromto":"f3g5"},{"color":"b","from":"h6","to":"g5","flags":"c","piece":"p","captured":"n","san":"hxg5","fromto":"h6g5"},{"color":"w","from":"h4","to":"g5","flags":"c","piece":"b","captured":"p","san":"Bxg5","fromto":"h4g5"},{"color":"b","from":"c8","to":"f5","flags":"n","piece":"b","san":"Bf5","fromto":"c8f5"},{"color":"w","from":"g5","to":"f6","flags":"c","piece":"b","captured":"n","san":"Bxf6","fromto":"g5f6"},{"color":"b","from":"d8","to":"f6","flags":"c","piece":"q","captured":"b","san":"Qxf6","fromto":"d8f6"},{"color":"w","from":"b1","to":"d2","flags":"n","piece":"n","san":"Nd2","fromto":"b1d2"},{"color":"b","from":"g8","to":"h8","flags":"n","piece":"k","san":"Kh8","fromto":"g8h8"},{"color":"w","from":"a5","to":"c7","flags":"c","piece":"q","captured":"p","san":"Qxc7","fromto":"a5c7"},{"color":"b","from":"f8","to":"g8","flags":"n","piece":"r","san":"Rg8","fromto":"f8g8"},{"color":"w","from":"d2","to":"f3","flags":"n","piece":"n","san":"Nf3","fromto":"d2f3"},{"color":"b","from":"f5","to":"h3","flags":"n","piece":"b","san":"Bh3","fromto":"f5h3"},{"color":"w","from":"f3","to":"e1","flags":"n","piece":"n","san":"Ne1","fromto":"f3e1"},{"color":"b","from":"h3","to":"g2","flags":"c","piece":"b","captured":"p","san":"Bxg2","fromto":"h3g2"},{"color":"w","from":"e1","to":"g2","flags":"c","piece":"n","captured":"b","san":"Nxg2","fromto":"e1g2"},{"color":"b","from":"f6","to":"g5","flags":"n","piece":"q","san":"Qg5","fromto":"f6g5"},{"color":"w","from":"c4","to":"e2","flags":"n","piece":"b","san":"Be2","fromto":"c4e2"},{"color":"b","from":"g5","to":"g2","flags":"c","piece":"q","captured":"n","san":"Qxg2#","fromto":"g5g2"}]'),p=JSON.parse('["rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1","rnbqkbnr/pppppppp/8/8/4P3/8/PPPP1PPP/RNBQKBNR b KQkq e3 0 1","rnbqkbnr/pppp1ppp/8/4p3/4P3/8/PPPP1PPP/RNBQKBNR w KQkq e6 0 2","rnbqkbnr/pppp1ppp/8/4p3/4P3/5N2/PPPP1PPP/RNBQKB1R b KQkq - 1 2","r1bqkbnr/pppp1ppp/2n5/4p3/4P3/5N2/PPPP1PPP/RNBQKB1R w KQkq - 2 3","r1bqkbnr/pppp1ppp/2n5/4p3/2B1P3/5N2/PPPP1PPP/RNBQK2R b KQkq - 3 3","r1bqk1nr/pppp1ppp/2n5/2b1p3/2B1P3/5N2/PPPP1PPP/RNBQK2R w KQkq - 4 4","r1bqk1nr/pppp1ppp/2n5/2b1p3/1PB1P3/5N2/P1PP1PPP/RNBQK2R b KQkq b3 0 4","r1bqk1nr/pppp1ppp/2n5/4p3/1bB1P3/5N2/P1PP1PPP/RNBQK2R w KQkq - 0 5","r1bqk1nr/pppp1ppp/2n5/4p3/1bB1P3/2P2N2/P2P1PPP/RNBQK2R b KQkq - 0 5","r1bqk1nr/pppp1ppp/2n5/b3p3/2B1P3/2P2N2/P2P1PPP/RNBQK2R w KQkq - 1 6","r1bqk1nr/pppp1ppp/2n5/b3p3/2B1P3/2P2N2/P2P1PPP/RNBQ1RK1 b kq - 2 6","r1bqk2r/pppp1ppp/2n2n2/b3p3/2B1P3/2P2N2/P2P1PPP/RNBQ1RK1 w kq - 3 7","r1bqk2r/pppp1ppp/2n2n2/b3p3/2BPP3/2P2N2/P4PPP/RNBQ1RK1 b kq d3 0 7","r1bqk2r/pppp1ppp/2n2n2/b7/2BpP3/2P2N2/P4PPP/RNBQ1RK1 w kq - 0 8","r1bqk2r/pppp1ppp/2n2n2/b7/2BPP3/5N2/P4PPP/RNBQ1RK1 b kq - 0 8","r1bqk2r/pppp1ppp/2n5/b7/2BPn3/5N2/P4PPP/RNBQ1RK1 w kq - 0 9","r1bqk2r/pppp1ppp/2n5/b2P4/2B1n3/5N2/P4PPP/RNBQ1RK1 b kq - 0 9","rnbqk2r/pppp1ppp/8/b2P4/2B1n3/5N2/P4PPP/RNBQ1RK1 w kq - 1 10","rnbqk2r/pppp1ppp/8/b2P4/2BQn3/5N2/P4PPP/RNB2RK1 b kq - 2 10","rnbqk2r/pppp1ppp/5n2/b2P4/2BQ4/5N2/P4PPP/RNB2RK1 w kq - 3 11","rnbqk2r/pppp1ppp/5n2/b1QP4/2B5/5N2/P4PPP/RNB2RK1 b kq - 4 11","rnbqk2r/ppp2ppp/3p1n2/b1QP4/2B5/5N2/P4PPP/RNB2RK1 w kq - 0 12","rnbqk2r/ppp2ppp/3p1n2/Q2P4/2B5/5N2/P4PPP/RNB2RK1 b kq - 0 12","rnbq1rk1/ppp2ppp/3p1n2/Q2P4/2B5/5N2/P4PPP/RNB2RK1 w - - 1 13","rnbq1rk1/ppp2ppp/3p1n2/Q2P2B1/2B5/5N2/P4PPP/RN3RK1 b - - 2 13","rnbq1rk1/ppp2pp1/3p1n1p/Q2P2B1/2B5/5N2/P4PPP/RN3RK1 w - - 0 14","rnbq1rk1/ppp2pp1/3p1n1p/Q2P4/2B4B/5N2/P4PPP/RN3RK1 b - - 1 14","rnbq1rk1/ppp2p2/3p1n1p/Q2P2p1/2B4B/5N2/P4PPP/RN3RK1 w - g6 0 15","rnbq1rk1/ppp2p2/3p1n1p/Q2P2N1/2B4B/8/P4PPP/RN3RK1 b - - 0 15","rnbq1rk1/ppp2p2/3p1n2/Q2P2p1/2B4B/8/P4PPP/RN3RK1 w - - 0 16","rnbq1rk1/ppp2p2/3p1n2/Q2P2B1/2B5/8/P4PPP/RN3RK1 b - - 0 16","rn1q1rk1/ppp2p2/3p1n2/Q2P1bB1/2B5/8/P4PPP/RN3RK1 w - - 1 17","rn1q1rk1/ppp2p2/3p1B2/Q2P1b2/2B5/8/P4PPP/RN3RK1 b - - 0 17","rn3rk1/ppp2p2/3p1q2/Q2P1b2/2B5/8/P4PPP/RN3RK1 w - - 0 18","rn3rk1/ppp2p2/3p1q2/Q2P1b2/2B5/8/P2N1PPP/R4RK1 b - - 1 18","rn3r1k/ppp2p2/3p1q2/Q2P1b2/2B5/8/P2N1PPP/R4RK1 w - - 2 19","rn3r1k/ppQ2p2/3p1q2/3P1b2/2B5/8/P2N1PPP/R4RK1 b - - 0 19","rn4rk/ppQ2p2/3p1q2/3P1b2/2B5/8/P2N1PPP/R4RK1 w - - 1 20","rn4rk/ppQ2p2/3p1q2/3P1b2/2B5/5N2/P4PPP/R4RK1 b - - 2 20","rn4rk/ppQ2p2/3p1q2/3P4/2B5/5N1b/P4PPP/R4RK1 w - - 3 21","rn4rk/ppQ2p2/3p1q2/3P4/2B5/7b/P4PPP/R3NRK1 b - - 4 21","rn4rk/ppQ2p2/3p1q2/3P4/2B5/8/P4PbP/R3NRK1 w - - 0 22","rn4rk/ppQ2p2/3p1q2/3P4/2B5/8/P4PNP/R4RK1 b - - 0 22","rn4rk/ppQ2p2/3p4/3P2q1/2B5/8/P4PNP/R4RK1 w - - 1 23","rn4rk/ppQ2p2/3p4/3P2q1/8/8/P3BPNP/R4RK1 b - - 2 23","rn4rk/ppQ2p2/3p4/3P4/8/8/P3BPqP/R4RK1 w - - 0 24"]')},689:(e,t,r)=>{r.d(t,{FB:()=>n,HX:()=>f,QZ:()=>a});var o=r(618);function n(e){const t=(0,o.qQ)();t.load_pgn(e);const r=t.history();var n=[];const a=(0,o.qQ)();return n.push(a.fen()),r.forEach(((e,t)=>{a.move(e),n.push(a.fen())})),n}function a(e){const t=(0,o.qQ)();t.load_pgn(e);const r=t.history({verbose:!0});return r.forEach(((e,t)=>{e.fromto=e.from+e.to})),r}const p={q:9,r:5,b:3,n:3,p:1,k:0};function i(e){return String.fromCharCode(97+e%8)+(8-Math.floor(e/8))}function s(e,t,r){if(r!=e.turn()){const t=l(e.fen());e=(0,o.qQ)(t)}let n=0;const a=e.get(t);if(null==a)return 0;if(a.color==r)return 0;const[p,i]=function(e,t,r){const o=e.get(t);if(o&&o.color===r)return[-1,-1];const n=function(e,t,r){const o=e.moves({verbose:!0});var n=[];for(const e of o)e.to==r&&n.push(e.from);return n}(e,0,t);let a=null,p=-1;for(const t of n){const r=e.get(t).type;(null===a||c(r)<c(a))&&(a=r,p=t)}return[a,p]}(e,t,r),P=a.type;return p&&P&&(function(e,t){e.move({from:t.substring(0,2),to:t.substring(2,4)})}(e,`${i}${t}`),n=Math.max(0,c(P)-s(e,t,function(e){return"w"===e?"b":"w"}(r))),function(e){e.undo()}(e)),n}function c(e){const t=e.toLowerCase();return p[t]}function l(e){var t=e.split(" ");return"w"==t[1]?t[1]="b":t[1]="w",t.join(" ")}function P(e){return e.split(" ")[1]}function h(e,t){let r=0;P(e)!=t&&(e=l(e));for(let o=0;o<64;o++)r=Math.max(r,d(e,i(o),t));return r}function d(e,t,r){return s((0,o.qQ)(e),t,r)}function u(e,t){const r=(0,o.qQ)();r.load(e);let n=0;for(let e=0;e<64;e++){const o=i(e),a=r.get(o);null!==a&&a.color===t&&(n+=c(a.type))}return n}function f(e,t,r,n){if(function(e){const t=(0,o.qQ)(e);return!(!t.in_check()||1!=t.moves.length)}(t))return!1;const a=P(e),p=u(e,a)-u(r,a),i=h(r,a),s=h(e,a);return d(t,n.substring(0,2),a)+1+p<d(r,n.substring(2,4),a)||(p?0<i-s-p:1<i-s-p)}},842:(e,t,r)=>{r.d(t,{e:()=>a});class o{constructor(){this.data={}}cachedDataToParsed(e){const t={};for(let r=0;r<2;r++)t[r]={},t[r].FEN=e.fen,"cp"in e.pvs[r]?(t[r].CP=e.pvs[r].cp,t[r].move=e.pvs[r].moves.split(" ")[0],t[r].cpOrMate="cp"):(t[r].CP=e.pvs[r].mate,t[r].move=e.pvs[r].moves.split(" ")[0],t[r].cpOrMate="mate"),t[r].depth=e.depth;return t}getEval(){return this.data[0].CP}sendMessage(e,t){const r="w"==t.split(" ")[1];if("info depth 0 score mate 0"==e)this.data[0]={move:-1,isCheckmated:!0,CP:r?1:-1,cpOrMate:"mate"},this.data[0].FEN=t,this.data[0].depth=123;else{const o=function(e){const t=e.match(/depth (\d+)/);return t?parseInt(t[1]):-1}(e),n=function(e){const t=e.match(/multipv\s(\d+)/);return t?parseInt(t[1]):null}(e),a=function(e){const t=e.match(/pv\s(\w{4})/);if(t)return t[1]}(e);if(a){const p=function(e,t){const r=e.match(/score cp (-?\d+)/),o=e.match(/score mate (-?\d+)/);return r?{value:parseInt(r[1]),cpOrMate:"cp",isWhiteMove:t}:o?{value:parseInt(o[1]),cpOrMate:"mate",isWhiteMove:t}:void 0}(e,r);this.data[n-1]={move:a,CP:p.value*(r?1:-1),cpOrMate:p.cpOrMate},this.data[n-1].FEN=t,this.data[n-1].depth=o}}}getAllData(){return this.data}clearData(){this.data={}}}var n=r(735);async function a(e){var t;await Stockfish().then((e=>{t=e}));const r=new p(t,e);return t.addMessageListener((e=>{r.handleMainMessage({from:"stockfish",message:e})})),r}class p{constructor(e,t){this.sendEvalAfterEveryMove=t,this.stockfishWorker=e,this.stockfishParser=new o,this.moveTimeLengthMs=t?1e5:n.D.STOCKFISH_MOVETIME,this.isCurrentlyWorking=null,this.currentFEN=null,this.analysisOrchestrator=null,this.whiteMove=!0,this.stockfishWorker.postMessage("setoption name Hash value 512"),this.stockfishWorker.postMessage("setoption name Threads value 1"),this.stockfishWorker.postMessage("setoption name MultiPV value 2"),self.onmessage=this.handleMainMessage.bind(this)}async getLichessData(e){return[!1]}async checkCache(e){const t=await this.getLichessData(e);return 1==t[0]?[!0,this.stockfishParser.cachedDataToParsed(t[1])]:[!1]}deleteWorker(){this.stockfishWorker.terminate()}clearData(){this.stockfishWorker.postMessage("stop"),this.stockfishParser.clearData(),this.whiteMove=!0,this.isCurrentlyWorking=!1}setCallback(e){this.callbackFunction=e}fillRestOfDataForAnalysisOrchestrator(e){var t={};return t.positionEvaluation=e,t.FENstring=this.currentFEN,t.regularMove=this.currentRegularMove,t.moveIndex=this.moveIndex,t}async getAnalsysForFenPosition(e,t,r){this.currentFEN=e,this.currentRegularMove=t,this.moveIndex=r;const o=await this.checkCache(e);if(1==o[0])return this.callbackFunction(this.fillRestOfDataForAnalysisOrchestrator(o[1])),void(this.isCurrentlyWorking=!1);this.stockfishWorker.postMessage(`position fen ${e}`),this.stockfishWorker.postMessage(`go movetime ${this.moveTimeLengthMs}`)}async waitForRun(e,t,r){for(;this.isCurrentlyWorking;)await new Promise((e=>setTimeout(e,100)));this.isCurrentlyWorking=!0,await this.getAnalsysForFenPosition(e,t,r)}async stopAndStartNewAnalysis(e){this.stockfishWorker.postMessage("stop"),this.getAnalsysForFenPosition(e,"",0)}handleMainMessage(e){e.from;const t=e.message;if(t.startsWith("bestmove")){this.whiteMove=!this.whiteMove;const e=this.stockfishParser.getAllData();var r=this.fillRestOfDataForAnalysisOrchestrator(e);this.stockfishParser.clearData(),this.sendEvalAfterEveryMove||this.callbackFunction(r),this.isCurrentlyWorking=!1}else{this.stockfishParser.sendMessage(t,this.currentFEN);const e=this.stockfishParser.getAllData();this.sendEvalAfterEveryMove&&this.callbackFunction(this.fillRestOfDataForAnalysisOrchestrator(e))}}}},392:(e,t,r)=>{r.a(e,(async(e,o)=>{try{r.d(t,{W3:()=>s,dF:()=>l,mY:()=>c,wV:()=>i});var n=r(824),a=r(618),p=e([n]);function i(e,t){const r=(0,a.qQ)();r.load(t);const o=r.move({from:e.substring(0,2),to:e.substring(2,4),promotion:"q"});return o?o.san:e}n=(p.then?(await p)():p)[0];const s={draggable:!0,position:"start",onDragStart:P,onDrop:d};function c(e,t,r){return Math.min(Math.max(e,t),r)}function l(e){return e[0].charCodeAt(0)-"a".charCodeAt(0)}function P(e){var t=null;t=n.tQ.getInAlternative?n.tQ.getAlternativeChessObject():n.tQ.getChessObject();const r=n.sV.getChessboard();return!t.game_over()&&(!("w"===t.turn()&&(o=e.piece,!/^w/.test(o)))&&(!("b"===t.turn()&&!h(e.piece))&&void t.moves({square:e.square,verbose:!0}).forEach((e=>{r.addCircle(e.to)}))));var o}function h(e){return/^b/.test(e)}function d(e){if(!("wP"==e.piece&&"8"==e.target[1]||"bP"==e.piece&&"1"==e.target[1]))return u(e.source,e.target,"q");{const t=n.tQ.getChessObject();console.log(t.fen());const r=t.move({from:e.source,to:e.target,promotion:"q"});if(t.undo(),!r)return console.log("SNAP"),"snapback";{console.log("PROMOCIJA");const t=e.piece[0];n.sV.createPromotionPopup(u,e.source,e.target,t)}}}function u(e,t,r){return console.log("P"),n.sV.getChessboard(),n.tQ.getChessObject(),n.tQ.makePossibleAlternativeMove(e+t,r)}o()}catch(f){o(f)}}))}},a={};function p(e){var t=a[e];if(void 0!==t)return t.exports;var r=a[e]={exports:{}};return n[e](r,r.exports,p),r.exports}e="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",r="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",o=e=>{e&&e.d<1&&(e.d=1,e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},p.a=(n,a,p)=>{var i;p&&((i=[]).d=-1);var s,c,l,P=new Set,h=n.exports,d=new Promise(((e,t)=>{l=t,c=e}));d[t]=h,d[e]=e=>(i&&e(i),P.forEach(e),d.catch((e=>{}))),n.exports=d,a((n=>{var a;s=(n=>n.map((n=>{if(null!==n&&"object"==typeof n){if(n[e])return n;if(n.then){var a=[];a.d=0,n.then((e=>{p[t]=e,o(a)}),(e=>{p[r]=e,o(a)}));var p={};return p[e]=e=>e(a),p}}var i={};return i[e]=e=>{},i[t]=n,i})))(n);var p=()=>s.map((e=>{if(e[r])throw e[r];return e[t]})),c=new Promise((t=>{(a=()=>t(p)).r=0;var r=e=>e!==i&&!P.has(e)&&(P.add(e),e&&!e.d&&(a.r++,e.push(a)));s.map((t=>t[e](r)))}));return a.r?c:p()}),(e=>(e?l(d[r]=e):c(h),o(i)))),i&&i.d<0&&(i.d=0)},p.d=(e,t)=>{for(var r in t)p.o(t,r)&&!p.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},p.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),p(824)})();